<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<title>tidyverse2018esj</title>
<link rel="stylesheet" href="/slides/reveal.js/css/reveal.css">
<link rel="stylesheet" href="/slides/reveal-theme.css">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  showProcessingMessages: false,
  messageStyle: "none",
  displayAlign: "left",
  displayIndent: "2em",
  tex2jax: {
    inlineMath: [['$','$']],
    displayMath: [['\\[', '\\]']]
  }
});
</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-AMS_CHTML"></script>

</head>

<body>
<div class="reveal">
<div class="slides">
<section>
<style type="text/css">
.reveal .slides,
.reveal h1,
.reveal h2,
.reveal h3 {
  font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Segoe UI", Helvetica, "Yu Gothic", sans-serif;
}
</style>

<h1 id="それもrにやらせよう-整然データの下ごしらえ">それもRにやらせよう &mdash; 整然データの下ごしらえ</h1>

<div class="author">Watal M. Iwasaki</div>

<div class="affiliation">SOKENDAI (The Graduate University for Advanced Studies)</div>

<div class="footnote">2018-03-14 生態学会65＠札幌</div>

</section>
<section>
<h2 id="下ごしらえを自動化してハッピーに">下ごしらえを自動化してハッピーに</h2>

<blockquote>
<p>Happy families are all alike;<br>
every unhappy family is unhappy in its own way<br>
&mdash; Leo Tolstoy &ldquo;Anna Karenina&rdquo;</p>

<p>tidy datasets are all alike,<br>
but every messy dataset is messy in its own way<br>
&mdash; Hadley Wickham</p>
</blockquote>

<dl>
<dt>出発点となるデータはさまざま</dt>
<dd>実験ノート、フィールドノート、</dd>
<dd>データベース、シミュレーション。。。</dd>
<dt>解析や作図に使えるデータ形式はほぼ決まってる</dt>
<dd><code>glm(..., data, ...)</code>,
<code>ggplot(data, ...)</code>, &hellip;</dd>
</dl>

</section>
<section>
<h2 id="整然データ-tidy-data">整然データ tidy data</h2>

<ul>
<li>1行は1つの観測</li>
<li>1列は1つの変数</li>
<li>1セルは1つの値</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">mtcars</code></pre></div>
<pre><code>                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
</code></pre>

<p>参考:
<a href="https://speakerdeck.com/fnshr/zheng-ran-detatutenani">https://speakerdeck.com/fnshr/zheng-ran-detatutenani</a>
「整然データってなに？」by <code>@f_nishihara</code></p>

</section>
<section>
<h2 id="雑然データ-messy-data">雑然データ messy data</h2>

<ul>
<li>データを採る/作るときに楽な形(これ自体は悪くない)</li>
<li>行にも列にも変数が混じっている</li>
<li>1つの観測が縦も横バラバラな位置に</li>
<li>1つのセルに複数の意味や値が含まれている</li>
<li>セルの結合？もってのほか！</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">VADeaths</code></pre></div>
<pre><code>      Rural Male Rural Female Urban Male Urban Female
50-54       11.7          8.7       15.4          8.4
55-59       18.1         11.7       24.3         13.6
60-64       26.9         20.3       37.0         19.3
65-69       41.0         30.9       54.6         35.1
70-74       66.0         54.3       71.1         50.0
</code></pre>

<p>↓下ごしらえ</p>

<pre><code># A tibble: 20 x 5
   lbound ubound region    sex death_rate
    &lt;int&gt;  &lt;int&gt;  &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt;
 1     50     54  Rural   Male       1.17
 2     55     59  Rural   Male       1.81
 3     60     64  Rural   Male       2.69
 4     65     69  Rural   Male       4.10
 5     70     74  Rural   Male       6.60
 6     50     54  Rural Female       0.87
 7     55     59  Rural Female       1.17
 8     60     64  Rural Female       2.03
 9     65     69  Rural Female       3.09
10     70     74  Rural Female       5.43
11     50     54  Urban   Male       1.54
12     55     59  Urban   Male       2.43
13     60     64  Urban   Male       3.70
14     65     69  Urban   Male       5.46
15     70     74  Urban   Male       7.11
16     50     54  Urban Female       0.84
17     55     59  Urban Female       1.36
18     60     64  Urban Female       1.93
19     65     69  Urban Female       3.51
20     70     74  Urban Female       5.00
</code></pre>

</section>
<section>
<h2 id="ゑくせる手作業-シーシュポスの岩">ゑくせる手作業 ＝ シーシュポスの岩</h2>

<ul>
<li>膨大な単純作業がそもそもツラい</li>
<li>人間だもの、ミスは防ぎきれない</li>
<li>なるべく防ぐためのチェックもツラい</li>
<li>ミスを発見 → 初めの工程からやり直し</li>
<li>新たなデータを追加 → 初めの工程からやり直し</li>
</ul>

<p>正確性が求められる退屈な仕事は人間よりも機械のほうが得意
</section>
<section>
<h2 id="tidyverse">tidyverse</h2>

<p>Rでデータを上手に扱うためのパッケージ群</p>

<ul>
<li>統一的な使い勝手</li>
<li>暗黙の処理をなるべくしない</li>
<li>意味のわかるエラーメッセージ</li>
<li><strong>シンプルな関数を繋げて使うようなデザイン</strong></li>
</ul>

<p>TODO: screenshot or logo <a href="https://www.tidyverse.org/">https://www.tidyverse.org/</a></p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">install.packages<span class="p">(</span><span class="s">&#34;tidyverse&#34;</span><span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span>
<span class="c1"># ggplot2, dplyr, tidyr, purrr, readr, tibble など、</span>
<span class="c1"># 主要なライブラリが一挙に読み込まれる</span></code></pre></div>
</section>
<section>
<h2 id="サンプルデータ-iris">サンプルデータ <code>iris</code></h2>

<p>Rに最初から入ってる。
3種のアヤメ150個体に関する4個の計測値。</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">head</span><span class="p">(</span>iris<span class="p">,</span> <span class="m">6L</span><span class="p">)</span></code></pre></div>
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa
</code></pre>

<p>まあまあtidy。</p>

</section>
<section>
<h2 id="dplyr">dplyr</h2>

<p><a href="http://dplyr.tidyverse.org/">
<img src="http://dplyr.tidyverse.org/logo.png" align="right">
</a></p>

<p>tidyverseの主要パッケージのひとつ。
data.frameに対して抽出、部分的変更、要約、ソートなどの処理を施す担当。</p>

<ul>
<li><code>filter()</code></li>
<li><code>select()</code></li>
<li><code>mutate()</code></li>
<li><code>group_by()</code></li>
<li><code>summarise()</code></li>
<li><code>arrange()</code></li>
<li><em>etc.</em></li>
</ul>

</section>
<section>
<h2 id="dplyr">dplyr</h2>

<p>TODO: 後のtidyrくらい詳しくひとつの関数ごとに説明する？</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span>
result <span class="o">=</span> iris <span class="o">%&gt;%</span>
  dplyr<span class="o">::</span>arrange<span class="p">(</span>Petal.Width<span class="p">)</span> <span class="o">%&gt;%</span>          <span class="c1"># 小さい順に並べ替え</span>
  dplyr<span class="o">::</span>filter<span class="p">(</span>Species <span class="o">!=</span> <span class="s">&#39;setosa&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>   <span class="c1"># 行を除外</span>
  dplyr<span class="o">::</span>select<span class="p">(</span><span class="o">-</span>matches<span class="p">(</span><span class="s">&#39;^Petal&#39;</span><span class="p">))</span> <span class="o">%&gt;%</span>    <span class="c1"># 列を除外</span>
  dplyr<span class="o">::</span>group_by<span class="p">(</span>Species<span class="p">)</span> <span class="o">%&gt;%</span>             <span class="c1"># グループごとに</span>
  dplyr<span class="o">::</span>summarise_all<span class="p">(</span><span class="kp">mean</span><span class="p">)</span> <span class="o">%&gt;%</span>           <span class="c1"># 平均を計算</span>
  dplyr<span class="o">::</span>mutate<span class="p">(</span>area <span class="o">=</span> Sepal.Length <span class="o">*</span> Sepal.Width <span class="o">/</span> <span class="m">2</span><span class="p">)</span> <span class="o">%&gt;%</span>
                                           <span class="c1"># 新しい列を作る</span>
  <span class="kp">print</span><span class="p">()</span>                                  <span class="c1"># 表示してみる</span></code></pre></div>
<pre><code># A tibble: 2 x 4
     Species Sepal.Length Sepal.Width     area
      &lt;fctr&gt;        &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;
1 versicolor        5.936       2.770 8.221360
2  virginica        6.588       2.974 9.796356
</code></pre>

<p><code>%&gt;%</code> これは何？</p>

</section>
<section>
<h2 id="パイプ演算子">パイプ演算子 <code>%&gt;%</code></h2>

<p>パイプの左側の変数を、右側の関数の第一引数にねじ込む</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span>
<span class="m">1</span> <span class="o">%&gt;%</span> <span class="kp">sum</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span></code></pre></div>
<pre><code>[1] 6
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">sum</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span></code></pre></div>
<pre><code>[1] 6
</code></pre>

<p>下ごしらえの流れ作業に便利</p>

<pre><code>データ   %&gt;%   処理A   %&gt;%   処理B   %&gt;%   処理C   %&gt;%   処理D
</code></pre>

</section>
<section>
<h2 id="パイプ演算子">パイプ演算子 <code>%&gt;%</code></h2>

<p>特定の行や列を除外してから、グループごとに平均値を計算したい</p>

<p>パイプを使わず、一時変数を使う方法:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">tmp1 <span class="o">=</span> dplyr<span class="o">::</span>filter<span class="p">(</span>iris<span class="p">,</span> Species <span class="o">!=</span> <span class="s">&#39;setosa&#39;</span><span class="p">)</span> <span class="c1"># 行を除外</span>
tmp2 <span class="o">=</span> dplyr<span class="o">::</span>select<span class="p">(</span>tmp1<span class="p">,</span> <span class="o">-</span>matches<span class="p">(</span><span class="s">&#39;^Petal&#39;</span><span class="p">))</span>  <span class="c1"># 列を除外</span>
tmp3 <span class="o">=</span> dplyr<span class="o">::</span>group_by<span class="p">(</span>tmp2<span class="p">,</span> Species<span class="p">)</span>           <span class="c1"># グループごとに</span>
result <span class="o">=</span> dplyr<span class="o">::</span>summarise_all<span class="p">(</span>tmp3<span class="p">,</span> <span class="kp">mean</span><span class="p">)</span>       <span class="c1"># 平均を計算</span></code></pre></div>
<p>もしくは全部同じ名前で:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">result <span class="o">=</span> dplyr<span class="o">::</span>filter<span class="p">(</span>iris<span class="p">,</span> Species <span class="o">!=</span> <span class="s">&#39;setosa&#39;</span><span class="p">)</span>  <span class="c1"># 行を除外</span>
result <span class="o">=</span> dplyr<span class="o">::</span>select<span class="p">(</span>result<span class="p">,</span> <span class="o">-</span>matches<span class="p">(</span><span class="s">&#39;^Petal&#39;</span><span class="p">))</span> <span class="c1"># 列を除外</span>
result <span class="o">=</span> dplyr<span class="o">::</span>group_by<span class="p">(</span>result<span class="p">,</span> Species<span class="p">)</span>          <span class="c1"># グループごとに</span>
result <span class="o">=</span> dplyr<span class="o">::</span>summarise_all<span class="p">(</span>result<span class="p">,</span> <span class="kp">mean</span><span class="p">)</span>        <span class="c1"># 平均を計算</span></code></pre></div>
<p>これらは全然悪くない。
でも変数名を何度も入力するのがやや冗長。</p>

</section>
<section>
<h2 id="パイプ演算子">パイプ演算子 <code>%&gt;%</code></h2>

<p>特定の行や列を除外してから、グループごとに平均値を計算したい</p>

<p>パイプも一時変数も使わない力技:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">result <span class="o">=</span> dplyr<span class="o">::</span>summarise_all<span class="p">(</span>            <span class="c1"># 平均を計算</span>
  dplyr<span class="o">::</span>group_by<span class="p">(</span>                          <span class="c1"># グループごとに</span>
    dplyr<span class="o">::</span>select<span class="p">(</span>                            <span class="c1"># 列を除外</span>
      dplyr<span class="o">::</span>filter<span class="p">(</span>iris<span class="p">,</span> Species <span class="o">!=</span> <span class="s">&#39;setosa&#39;</span><span class="p">),</span> <span class="c1"># 行を除外</span>
      <span class="o">-</span>matches<span class="p">(</span><span class="s">&#39;^Petal&#39;</span><span class="p">)),</span>                    <span class="c1"># 列を除外</span>
    Species<span class="p">),</span>                               <span class="c1"># グループごとに</span>
  <span class="kp">mean</span><span class="p">)</span>                                   <span class="c1"># 平均を計算</span></code></pre></div>
<p>論理の流れとプログラムの流れが合わず、目が行ったり来たり。<br>
さっきのほうがぜんぜんマシ。</p>

</section>
<section>
<h2 id="パイプ演算子">パイプ演算子 <code>%&gt;%</code></h2>

<p>特定の行や列を除外してから、グループごとに平均値を計算したい</p>

<p>パイプを使えばスッキリ:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span>
result <span class="o">=</span> iris <span class="o">%&gt;%</span>
  dplyr<span class="o">::</span>filter<span class="p">(</span>Species <span class="o">!=</span> <span class="s">&#39;setosa&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>   <span class="c1"># 行を除外</span>
  dplyr<span class="o">::</span>select<span class="p">(</span><span class="o">-</span>matches<span class="p">(</span><span class="s">&#39;^Petal&#39;</span><span class="p">))</span> <span class="o">%&gt;%</span>    <span class="c1"># 列を除外</span>
  dplyr<span class="o">::</span>group_by<span class="p">(</span>Species<span class="p">)</span> <span class="o">%&gt;%</span>             <span class="c1"># グループごとに</span>
  dplyr<span class="o">::</span>summarise_all<span class="p">(</span><span class="kp">mean</span><span class="p">)</span> <span class="o">%&gt;%</span>           <span class="c1"># 平均を計算</span>
  <span class="kp">print</span><span class="p">()</span>                                  <span class="c1"># 表示してみる</span></code></pre></div>
<pre><code># A tibble: 2 x 3
     Species Sepal.Length Sepal.Width
      &lt;fctr&gt;        &lt;dbl&gt;       &lt;dbl&gt;
1 versicolor        5.936       2.770
2  virginica        6.588       2.974
</code></pre>

<p>慣れるまではちょっと大変かも。無理して使わなくでも大丈夫。<br>
でも、一旦慣れれば断然読みやすい、書きやすい。</p>

</section>
<section>
<h2 id="tidyr">tidyr</h2>

<p><a href="http://tidyr.tidyverse.org/">
<img src="http://tidyr.tidyverse.org/logo.png" align="right">
</a></p>

<p>tidyverseの主要パッケージのひとつ。
data.frameを縦長・横長・入れ子に変形・整形するところを担当。</p>

<ul>
<li><code>gather()</code> 横長から縦長に</li>
<li><code>spread()</code> 縦長から横長に</li>
<li><code>nest()</code> 入れ子に</li>
<li><code>unnest()</code> 入れ子解消</li>
<li><code>separate()</code> 1列を複数の列に分離</li>
<li><em>etc.</em></li>
</ul>

</section>
<section>
<h2 id="tidyr-gather-横長から縦長に"><code>tidyr::gather()</code> 横長から縦長に</h2>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">iris <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">(</span><span class="m">2L</span><span class="p">)</span> <span class="o">%&gt;%</span>                           <span class="c1"># 最初の2行だけ</span>
  rownames_to_column<span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>                  <span class="c1"># IDカラムを追加</span>
  <span class="kp">print</span><span class="p">()</span> <span class="o">%&gt;%</span>                                   <span class="c1"># 途中経過を表示</span>
  tidyr<span class="o">::</span>gather<span class="p">(</span>name<span class="p">,</span> value<span class="p">,</span> <span class="o">-</span>id<span class="p">,</span> <span class="o">-</span>Species<span class="p">)</span>     <span class="c1"># 縦長に変形</span></code></pre></div>
<pre><code>  id Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1  1          5.1         3.5          1.4         0.2  setosa
2  2          4.9         3.0          1.4         0.2  setosa
</code></pre>

<pre><code>  id Species         name value
1  1  setosa Sepal.Length   5.1
2  2  setosa Sepal.Length   4.9
3  1  setosa  Sepal.Width   3.5
4  2  setosa  Sepal.Width   3.0
5  1  setosa Petal.Length   1.4
6  2  setosa Petal.Length   1.4
7  1  setosa  Petal.Width   0.2
8  2  setosa  Petal.Width   0.2
</code></pre>

</section>
<section>
<h2 id="tidyr-spread-縦長から横長に"><code>tidyr::spread()</code> 縦長から横長に</h2>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">iris <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">(</span><span class="m">2L</span><span class="p">)</span> <span class="o">%&gt;%</span>                           <span class="c1"># 最初の2行だけ</span>
  rownames_to_column<span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>                  <span class="c1"># IDカラムを追加</span>
  tidyr<span class="o">::</span>gather<span class="p">(</span>name<span class="p">,</span> value<span class="p">,</span> <span class="o">-</span>id<span class="p">,</span> <span class="o">-</span>Species<span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># 縦長に変形</span>
  <span class="kp">print</span><span class="p">()</span> <span class="o">%&gt;%</span>                                   <span class="c1"># 途中経過を表示</span>
  tidyr<span class="o">::</span>spread<span class="p">(</span>name<span class="p">,</span> value<span class="p">)</span>                    <span class="c1"># 横長に戻す</span></code></pre></div>
<pre><code>  id Species         name value
1  1  setosa Sepal.Length   5.1
2  2  setosa Sepal.Length   4.9
3  1  setosa  Sepal.Width   3.5
4  2  setosa  Sepal.Width   3.0
5  1  setosa Petal.Length   1.4
6  2  setosa Petal.Length   1.4
7  1  setosa  Petal.Width   0.2
8  2  setosa  Petal.Width   0.2
</code></pre>

<pre><code>  id Species Petal.Length Petal.Width Sepal.Length Sepal.Width
1  1  setosa          1.4         0.2          5.1         3.5
2  2  setosa          1.4         0.2          4.9         3.0
</code></pre>

</section>
<section>
<h2 id="tidyr-separate-列を分離"><code>tidyr::separate()</code> 列を分離</h2>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">iris <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">(</span><span class="m">2L</span><span class="p">)</span> <span class="o">%&gt;%</span>                           <span class="c1"># 最初の2行だけ</span>
  rownames_to_column<span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>                  <span class="c1"># IDカラムを追加</span>
  tidyr<span class="o">::</span>gather<span class="p">(</span>name<span class="p">,</span> value<span class="p">,</span> <span class="o">-</span>id<span class="p">,</span> <span class="o">-</span>Species<span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># 縦長に変形</span>
  <span class="kp">print</span><span class="p">()</span> <span class="o">%&gt;%</span>                                   <span class="c1"># 途中経過を表示</span>
  tidyr<span class="o">::</span>separate<span class="p">(</span>name<span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;part&#39;</span><span class="p">,</span> <span class="s">&#39;measure&#39;</span><span class="p">))</span>   <span class="c1"># 列を分離</span></code></pre></div>
<pre><code>  id Species         name value
1  1  setosa Sepal.Length   5.1
2  2  setosa Sepal.Length   4.9
3  1  setosa  Sepal.Width   3.5
4  2  setosa  Sepal.Width   3.0
5  1  setosa Petal.Length   1.4
6  2  setosa Petal.Length   1.4
7  1  setosa  Petal.Width   0.2
8  2  setosa  Petal.Width   0.2
</code></pre>

<pre><code>  id Species  part measure value
1  1  setosa Sepal  Length   5.1
2  2  setosa Sepal  Length   4.9
3  1  setosa Sepal   Width   3.5
4  2  setosa Sepal   Width   3.0
5  1  setosa Petal  Length   1.4
6  2  setosa Petal  Length   1.4
7  1  setosa Petal   Width   0.2
8  2  setosa Petal   Width   0.2
</code></pre>

</section>
<section>
<h2 id="tidyr-nest-入れ子にする"><code>tidyr::nest()</code> 入れ子にする</h2>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">nested <span class="o">=</span> iris <span class="o">%&gt;%</span>
  tidyr<span class="o">::</span>nest<span class="p">(</span><span class="o">-</span>Species<span class="p">)</span> <span class="o">%&gt;%</span> <span class="kp">print</span><span class="p">()</span></code></pre></div>
<pre><code># A tibble: 3 x 2
     Species                  data
      &lt;fctr&gt;                &lt;list&gt;
1     setosa &lt;data.frame [50 x 4]&gt;
2 versicolor &lt;data.frame [50 x 4]&gt;
3  virginica &lt;data.frame [50 x 4]&gt;
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">nested<span class="o">$</span>data<span class="p">[[</span><span class="m">1L</span><span class="p">]]</span></code></pre></div>
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width
1           5.1         3.5          1.4         0.2
2           4.9         3.0          1.4         0.2
3           4.7         3.2          1.3         0.2
4           4.6         3.1          1.5         0.2
5           5.0         3.6          1.4         0.2
6           5.4         3.9          1.7         0.4
7           4.6         3.4          1.4         0.3
8           5.0         3.4          1.5         0.2
9           4.4         2.9          1.4         0.2
10          4.9         3.1          1.5         0.1
11          5.4         3.7          1.5         0.2
12          4.8         3.4          1.6         0.2
13          4.8         3.0          1.4         0.1
14          4.3         3.0          1.1         0.1
15          5.8         4.0          1.2         0.2
16          5.7         4.4          1.5         0.4
17          5.4         3.9          1.3         0.4
18          5.1         3.5          1.4         0.3
19          5.7         3.8          1.7         0.3
20          5.1         3.8          1.5         0.3
21          5.4         3.4          1.7         0.2
22          5.1         3.7          1.5         0.4
23          4.6         3.6          1.0         0.2
24          5.1         3.3          1.7         0.5
25          4.8         3.4          1.9         0.2
26          5.0         3.0          1.6         0.2
27          5.0         3.4          1.6         0.4
28          5.2         3.5          1.5         0.2
29          5.2         3.4          1.4         0.2
30          4.7         3.2          1.6         0.2
31          4.8         3.1          1.6         0.2
32          5.4         3.4          1.5         0.4
33          5.2         4.1          1.5         0.1
34          5.5         4.2          1.4         0.2
35          4.9         3.1          1.5         0.2
36          5.0         3.2          1.2         0.2
37          5.5         3.5          1.3         0.2
38          4.9         3.6          1.4         0.1
39          4.4         3.0          1.3         0.2
40          5.1         3.4          1.5         0.2
41          5.0         3.5          1.3         0.3
42          4.5         2.3          1.3         0.3
43          4.4         3.2          1.3         0.2
44          5.0         3.5          1.6         0.6
45          5.1         3.8          1.9         0.4
46          4.8         3.0          1.4         0.3
47          5.1         3.8          1.6         0.2
48          4.6         3.2          1.4         0.2
49          5.3         3.7          1.5         0.2
50          5.0         3.3          1.4         0.2
</code></pre>

<p>入れ子にされたlistの列どうする？
<code>purrr::map()</code>の出番！</p>

</section>
<section>
<h2 id="purrr">purrr</h2>

<p><a href="http://purrr.tidyverse.org/">
<img src="http://purrr.tidyverse.org/logo.png" align="right">
</a></p>

<p>tidyverseの主要パッケージのひとつ。
listやループの処理担当。
R標準の<code>sapply</code>とか<code>lapply</code>とかは使い方おぼえにくいので。。。</p>

<ul>
<li><code>map()</code></li>
<li><code>flatten()</code></li>
<li><em>etc.</em></li>
</ul>

</section>
<section>
<h2 id="purrr-map"><code>purrr::map()</code></h2>

<p>TODO?
</section>
<section>
<h2 id="例題-anscombe">例題 <code>anscombe</code></h2>

<p>4組のx-yは、平均・分散・相関係数がほぼ同じ？</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">anscombe <span class="o">%&gt;%</span>
  tibble<span class="o">::</span>rownames_to_column<span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span>       <span class="c1"># あとで必要なID列</span>
  <span class="c1"># 横長のままでは扱いにくいの縦長にしたい</span></code></pre></div>
<pre><code>   id x1 x2 x3 x4    y1   y2    y3    y4
1   1 10 10 10  8  8.04 9.14  7.46  6.58
2   2  8  8  8  8  6.95 8.14  6.77  5.76
3   3 13 13 13  8  7.58 8.74 12.74  7.71
4   4  9  9  9  8  8.81 8.77  7.11  8.84
5   5 11 11 11  8  8.33 9.26  7.81  8.47
6   6 14 14 14  8  9.96 8.10  8.84  7.04
7   7  6  6  6  8  7.24 6.13  6.08  5.25
8   8  4  4  4 19  4.26 3.10  5.39 12.50
9   9 12 12 12  8 10.84 9.13  8.15  5.56
10 10  7  7  7  8  4.82 7.26  6.42  7.91
11 11  5  5  5  8  5.68 4.74  5.73  6.89
</code></pre>

</section>
<section>
<h2 id="例題-anscombe">例題 <code>anscombe</code></h2>

<p>関数をつないで下ごしらえ</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">anscombe <span class="o">%&gt;%</span>
  tibble<span class="o">::</span>rownames_to_column<span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>   <span class="c1"># あとで必要なID列</span>
  tidyr<span class="o">::</span>gather<span class="p">(</span>key<span class="p">,</span> value<span class="p">,</span> <span class="o">-</span>id<span class="p">)</span>         <span class="c1"># 縦長に変形</span>
  <span class="c1"># key列の x1 とかを x, 1 の2列に分離したい</span></code></pre></div>
<pre><code>   id key value
1   1  x1 10.00
2   2  x1  8.00
3   3  x1 13.00
4   4  x1  9.00
5   5  x1 11.00
6   6  x1 14.00
7   7  x1  6.00
8   8  x1  4.00
9   9  x1 12.00
10 10  x1  7.00
11 11  x1  5.00
12  1  x2 10.00
13  2  x2  8.00
14  3  x2 13.00
15  4  x2  9.00
16  5  x2 11.00
17  6  x2 14.00
18  7  x2  6.00
19  8  x2  4.00
20  9  x2 12.00
21 10  x2  7.00
22 11  x2  5.00
23  1  x3 10.00
24  2  x3  8.00
25  3  x3 13.00
26  4  x3  9.00
27  5  x3 11.00
28  6  x3 14.00
29  7  x3  6.00
30  8  x3  4.00
31  9  x3 12.00
32 10  x3  7.00
33 11  x3  5.00
34  1  x4  8.00
35  2  x4  8.00
36  3  x4  8.00
37  4  x4  8.00
38  5  x4  8.00
39  6  x4  8.00
40  7  x4  8.00
41  8  x4 19.00
42  9  x4  8.00
43 10  x4  8.00
44 11  x4  8.00
45  1  y1  8.04
46  2  y1  6.95
47  3  y1  7.58
48  4  y1  8.81
49  5  y1  8.33
50  6  y1  9.96
51  7  y1  7.24
52  8  y1  4.26
53  9  y1 10.84
54 10  y1  4.82
55 11  y1  5.68
56  1  y2  9.14
57  2  y2  8.14
58  3  y2  8.74
59  4  y2  8.77
60  5  y2  9.26
61  6  y2  8.10
62  7  y2  6.13
63  8  y2  3.10
64  9  y2  9.13
65 10  y2  7.26
66 11  y2  4.74
67  1  y3  7.46
68  2  y3  6.77
69  3  y3 12.74
70  4  y3  7.11
71  5  y3  7.81
72  6  y3  8.84
73  7  y3  6.08
74  8  y3  5.39
75  9  y3  8.15
76 10  y3  6.42
77 11  y3  5.73
78  1  y4  6.58
79  2  y4  5.76
80  3  y4  7.71
81  4  y4  8.84
82  5  y4  8.47
83  6  y4  7.04
84  7  y4  5.25
85  8  y4 12.50
86  9  y4  5.56
87 10  y4  7.91
88 11  y4  6.89
</code></pre>

</section>
<section>
<h2 id="例題-anscombe">例題 <code>anscombe</code></h2>

<p>関数をつないで下ごしらえ</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">anscombe <span class="o">%&gt;%</span>
  tibble<span class="o">::</span>rownames_to_column<span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>   <span class="c1"># あとで必要なID列</span>
  tidyr<span class="o">::</span>gather<span class="p">(</span>key<span class="p">,</span> value<span class="p">,</span> <span class="o">-</span>id<span class="p">)</span> <span class="o">%&gt;%</span>     <span class="c1"># 縦長に変形</span>
  tidyr<span class="o">::</span>separate<span class="p">(</span>key<span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;axis&#39;</span><span class="p">,</span> <span class="s">&#39;group&#39;</span><span class="p">),</span> <span class="m">1L</span><span class="p">)</span>      <span class="c1"># 列を分離</span>
  <span class="c1"># xとyのペアが1行になってほしい</span>
  <span class="c1"># xとyが新たな列名になるように横長にしたい</span></code></pre></div>
<pre><code>   id axis group value
1   1    x     1 10.00
2   2    x     1  8.00
3   3    x     1 13.00
4   4    x     1  9.00
5   5    x     1 11.00
6   6    x     1 14.00
7   7    x     1  6.00
8   8    x     1  4.00
9   9    x     1 12.00
10 10    x     1  7.00
11 11    x     1  5.00
12  1    x     2 10.00
13  2    x     2  8.00
14  3    x     2 13.00
15  4    x     2  9.00
16  5    x     2 11.00
17  6    x     2 14.00
18  7    x     2  6.00
19  8    x     2  4.00
20  9    x     2 12.00
21 10    x     2  7.00
22 11    x     2  5.00
23  1    x     3 10.00
24  2    x     3  8.00
25  3    x     3 13.00
26  4    x     3  9.00
27  5    x     3 11.00
28  6    x     3 14.00
29  7    x     3  6.00
30  8    x     3  4.00
31  9    x     3 12.00
32 10    x     3  7.00
33 11    x     3  5.00
34  1    x     4  8.00
35  2    x     4  8.00
36  3    x     4  8.00
37  4    x     4  8.00
38  5    x     4  8.00
39  6    x     4  8.00
40  7    x     4  8.00
41  8    x     4 19.00
42  9    x     4  8.00
43 10    x     4  8.00
44 11    x     4  8.00
45  1    y     1  8.04
46  2    y     1  6.95
47  3    y     1  7.58
48  4    y     1  8.81
49  5    y     1  8.33
50  6    y     1  9.96
51  7    y     1  7.24
52  8    y     1  4.26
53  9    y     1 10.84
54 10    y     1  4.82
55 11    y     1  5.68
56  1    y     2  9.14
57  2    y     2  8.14
58  3    y     2  8.74
59  4    y     2  8.77
60  5    y     2  9.26
61  6    y     2  8.10
62  7    y     2  6.13
63  8    y     2  3.10
64  9    y     2  9.13
65 10    y     2  7.26
66 11    y     2  4.74
67  1    y     3  7.46
68  2    y     3  6.77
69  3    y     3 12.74
70  4    y     3  7.11
71  5    y     3  7.81
72  6    y     3  8.84
73  7    y     3  6.08
74  8    y     3  5.39
75  9    y     3  8.15
76 10    y     3  6.42
77 11    y     3  5.73
78  1    y     4  6.58
79  2    y     4  5.76
80  3    y     4  7.71
81  4    y     4  8.84
82  5    y     4  8.47
83  6    y     4  7.04
84  7    y     4  5.25
85  8    y     4 12.50
86  9    y     4  5.56
87 10    y     4  7.91
88 11    y     4  6.89
</code></pre>

</section>
<section>
<h2 id="例題-anscombe">例題 <code>anscombe</code></h2>

<p>関数をつないで下ごしらえ</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">anscombe <span class="o">%&gt;%</span>
  tibble<span class="o">::</span>rownames_to_column<span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>   <span class="c1"># あとで必要なID列</span>
  tidyr<span class="o">::</span>gather<span class="p">(</span>key<span class="p">,</span> value<span class="p">,</span> <span class="o">-</span>id<span class="p">)</span> <span class="o">%&gt;%</span>     <span class="c1"># 縦長に変形</span>
  tidyr<span class="o">::</span>separate<span class="p">(</span>key<span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;axis&#39;</span><span class="p">,</span> <span class="s">&#39;group&#39;</span><span class="p">),</span> <span class="m">1L</span><span class="p">)</span> <span class="o">%&gt;%</span>  <span class="c1"># 列を分離</span>
  tidyr<span class="o">::</span>spread<span class="p">(</span>axis<span class="p">,</span> value<span class="p">)</span>             <span class="c1"># axis列をx列とy列に</span></code></pre></div>
<pre><code>   id group  x     y
1   1     1 10  8.04
2   1     2 10  9.14
3   1     3 10  7.46
4   1     4  8  6.58
5  10     1  7  4.82
6  10     2  7  7.26
7  10     3  7  6.42
8  10     4  8  7.91
9  11     1  5  5.68
10 11     2  5  4.74
11 11     3  5  5.73
12 11     4  8  6.89
13  2     1  8  6.95
14  2     2  8  8.14
15  2     3  8  6.77
16  2     4  8  5.76
17  3     1 13  7.58
18  3     2 13  8.74
19  3     3 13 12.74
20  3     4  8  7.71
21  4     1  9  8.81
22  4     2  9  8.77
23  4     3  9  7.11
24  4     4  8  8.84
25  5     1 11  8.33
26  5     2 11  9.26
27  5     3 11  7.81
28  5     4  8  8.47
29  6     1 14  9.96
30  6     2 14  8.10
31  6     3 14  8.84
32  6     4  8  7.04
33  7     1  6  7.24
34  7     2  6  6.13
35  7     3  6  6.08
36  7     4  8  5.25
37  8     1  4  4.26
38  8     2  4  3.10
39  8     3  4  5.39
40  8     4 19 12.50
41  9     1 12 10.84
42  9     2 12  9.13
43  9     3 12  8.15
44  9     4  8  5.56
</code></pre>

</section>
<section>
<h2 id="例題-anscombe">例題 <code>anscombe</code></h2>

<p>関数をつないで下ごしらえ</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">tidy_anscombe <span class="o">=</span> anscombe <span class="o">%&gt;%</span>
  tibble<span class="o">::</span>rownames_to_column<span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>   <span class="c1"># あとで必要なID列</span>
  tidyr<span class="o">::</span>gather<span class="p">(</span>key<span class="p">,</span> value<span class="p">,</span> <span class="o">-</span>id<span class="p">)</span> <span class="o">%&gt;%</span>     <span class="c1"># 縦長に変形</span>
  tidyr<span class="o">::</span>separate<span class="p">(</span>key<span class="p">,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;axis&#39;</span><span class="p">,</span> <span class="s">&#39;group&#39;</span><span class="p">),</span> <span class="m">1L</span><span class="p">)</span> <span class="o">%&gt;%</span>  <span class="c1"># 列を分離</span>
  tidyr<span class="o">::</span>spread<span class="p">(</span>axis<span class="p">,</span> value<span class="p">)</span> <span class="o">%&gt;%</span>         <span class="c1"># axis列をx列とy列に</span>
  dplyr<span class="o">::</span>select<span class="p">(</span><span class="o">-</span>id<span class="p">)</span> <span class="o">%&gt;%</span>                 <span class="c1"># 使い終わったID列を消す</span>
  dplyr<span class="o">::</span>arrange<span class="p">(</span>group<span class="p">)</span> <span class="o">%&gt;%</span>              <span class="c1"># グループごとに並べる</span>
  <span class="kp">print</span><span class="p">()</span></code></pre></div>
<pre><code>   group  x     y
1      1 10  8.04
2      1  7  4.82
3      1  5  5.68
4      1  8  6.95
5      1 13  7.58
6      1  9  8.81
7      1 11  8.33
8      1 14  9.96
9      1  6  7.24
10     1  4  4.26
11     1 12 10.84
12     2 10  9.14
13     2  7  7.26
14     2  5  4.74
15     2  8  8.14
16     2 13  8.74
17     2  9  8.77
18     2 11  9.26
19     2 14  8.10
20     2  6  6.13
21     2  4  3.10
22     2 12  9.13
23     3 10  7.46
24     3  7  6.42
25     3  5  5.73
26     3  8  6.77
27     3 13 12.74
28     3  9  7.11
29     3 11  7.81
30     3 14  8.84
31     3  6  6.08
32     3  4  5.39
33     3 12  8.15
34     4  8  6.58
35     4  8  7.91
36     4  8  6.89
37     4  8  5.76
38     4  8  7.71
39     4  8  8.84
40     4  8  8.47
41     4  8  7.04
42     4  8  5.25
43     4 19 12.50
44     4  8  5.56
</code></pre>

</section>
<section>
<h2 id="例題-anscombe">例題 <code>anscombe</code></h2>

<p>とりあえずプロット</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">tidy_anscombe <span class="o">%&gt;%</span>
  ggplot<span class="p">(</span>aes<span class="p">(</span>x<span class="p">,</span> y<span class="p">))</span><span class="o">+</span>
  geom_point<span class="p">(</span>size <span class="o">=</span> <span class="m">3</span><span class="p">)</span><span class="o">+</span>
  stat_smooth<span class="p">(</span>method <span class="o">=</span> lm<span class="p">,</span> se <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> fullrange <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span><span class="o">+</span>
  facet_wrap<span class="p">(</span><span class="o">~</span> group<span class="p">,</span> nrow <span class="o">=</span> <span class="m">1L</span><span class="p">)</span></code></pre></div>
<p><img src="figure/plot_anscombe-1.png" title="plot of chunk plot_anscombe" alt="plot of chunk plot_anscombe" width="95%" /></p>

</section>
<section>
<h2 id="例題-anscombe">例題 <code>anscombe</code></h2>

<p>dplyrのグループ化を使って要約</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">tidy_anscombe <span class="o">%&gt;%</span>
  dplyr<span class="o">::</span>group_by<span class="p">(</span>group<span class="p">)</span> <span class="o">%&gt;%</span>   <span class="c1"># group列でグループ化して</span>
  dplyr<span class="o">::</span>summarise<span class="p">(</span>            <span class="c1"># x, y列を使ってsummarize</span>
    mean_x <span class="o">=</span> <span class="kp">mean</span><span class="p">(</span>x<span class="p">),</span>
    mean_y <span class="o">=</span> <span class="kp">mean</span><span class="p">(</span>y<span class="p">),</span>
    sd_x <span class="o">=</span> sd<span class="p">(</span>x<span class="p">),</span>
    sd_y <span class="o">=</span> sd<span class="p">(</span>y<span class="p">),</span>
    cor_xy <span class="o">=</span> cor<span class="p">(</span>x<span class="p">,</span> y<span class="p">)</span>
  <span class="p">)</span></code></pre></div>
<pre><code># A tibble: 4 x 6
  group mean_x   mean_y     sd_x     sd_y    cor_xy
  &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1     1      9 7.500909 3.316625 2.031568 0.8164205
2     2      9 7.500909 3.316625 2.031657 0.8162365
3     3      9 7.500000 3.316625 2.030424 0.8162867
4     4      9 7.500909 3.316625 2.030579 0.8165214
</code></pre>

</section>
<section>
<h2 id="例題-anscombe">例題 <code>anscombe</code></h2>

<p>tidyrのネストを使って要約</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">tidy_anscombe <span class="o">%&gt;%</span>
  tidyr<span class="o">::</span>nest<span class="p">(</span><span class="o">-</span>group<span class="p">)</span> <span class="o">%&gt;%</span>       <span class="c1"># group列でネストして</span>
  dplyr<span class="o">::</span>mutate<span class="p">(</span>data <span class="o">=</span> purrr<span class="o">::</span>map<span class="p">(</span>data<span class="p">,</span> <span class="o">~</span><span class="p">{</span>
    <span class="m">.</span>x <span class="o">%&gt;%</span>
      summarise_all<span class="p">(</span>funs<span class="p">(</span><span class="kp">mean</span><span class="p">,</span> sd<span class="p">))</span> <span class="o">%&gt;%</span>
      dplyr<span class="o">::</span>mutate<span class="p">(</span>cor_xy <span class="o">=</span> cor<span class="p">(</span><span class="m">.</span>x<span class="o">$</span>x<span class="p">,</span> <span class="m">.</span>x<span class="o">$</span>y<span class="p">))</span>
  <span class="p">}))</span> <span class="o">%&gt;%</span>
  tidyr<span class="o">::</span>unnest<span class="p">()</span></code></pre></div>
<pre><code># A tibble: 4 x 6
  group x_mean   y_mean     x_sd     y_sd    cor_xy
  &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1     1      9 7.500909 3.316625 2.031568 0.8164205
2     2      9 7.500909 3.316625 2.031657 0.8162365
3     3      9 7.500000 3.316625 2.030424 0.8162867
4     4      9 7.500909 3.316625 2.030579 0.8165214
</code></pre>

</section>
<section>
<h2 id="例題-先ほどの伊東さんのデータ準備部分">例題 先ほどの伊東さんのデータ準備部分</h2>

<p><a href="https://github.com/ito4303/esj65">https://github.com/ito4303/esj65</a>
</section>
<section>
<h2 id="例題-vadeaths">例題 <code>VADeaths</code></h2>

</section>
<section>
<h2 id="参考">参考</h2>

<p>&ldquo;R for Data Science&rdquo; Hadley Wickham and Garrett Grolemund
<a href="https://amzn.to/2yyFRKt">日本語版書籍(Rではじめるデータサイエンス)</a>
<a href="https://amzn.to/2tbRmVc">英語版書籍</a>
<a href="http://r4ds.had.co.nz/">無料Web版</a></p>

<p>各パッケージの公式ドキュメント</p>

<ul>
<li><a href="https://www.tidyverse.org/">tidyverse</a></li>
<li><a href="http://tidyr.tidyverse.org/">tidyr</a></li>
<li><a href="http://dplyr.tidyverse.org/">dplyr</a></li>
<li><a href="http://purrrr.tidyverse.org/">purrr</a></li>
</ul>

</section>
<section>
<h2 id="エラーや疑問の解決方法">エラーや疑問の解決方法</h2>

<ul>
<li>エラー文をちゃんと読む</li>
<li>エラー文をGoogleにコピペする -&gt; だいたいStackOverflowや個人ウェブサイトに先例が見つかる</li>
<li>身近な経験者に訊く</li>
<li>Slackの <a href="https://github.com/tokyor/r-wakalang">r-wakalang</a> に質問を投稿する</li>
</ul>

</section>
<section>
<h2 id="まとめ">まとめ</h2>

</section>
</div>
</div>
<script src="/slides/reveal.js/lib/js/head.min.js"></script>
<script src="/slides/reveal.js/js/reveal.js"></script>
<script>
Reveal.initialize({
  width: 960,
  height: 720,
  margin: 0,
  controls: false,
  controlsTutorial: false,
  progress: false,
  slideNumber: 'c/t',
  history: false,
  center: false,
  embedded: false,
  transition: 'none',
  transitionSpeed: 'fast',
  backgroundTransition: 'none',
  viewDistance: 1,
  dependencies: [
    { src: '\/slides\/reveal.js\/plugin\/notes\/notes.js', async: true }
  ]
});
</script>

</body>
</html>

